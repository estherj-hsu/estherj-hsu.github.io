<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&family=Rubik:ital,wght@0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css integrity=sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l crossorigin=anonymous><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/syntax.css><title>CSS優化項目之一：多語系選單 ｜ Esther's Life</title><meta name=description content="esther 想記錄一下自己去年優化的幾個部分，不堪回想的血淚&amp;hellip; T^T
剛接觸 sass 時，會被他很厲害的功能迷惑，
曾經我也不自覺地濫用了很多的 @extend，
但是如果弄清楚需求與效能後，
會知道很多東西其實維持舊寫法才是比較適當的選擇。
就讓我們繼續看下去吧&amp;hellip;"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-ZS1GBZ1JP6','auto');ga('send','pageview');}</script><link rel="shortcut icon" href=/images/favicon.ico></head><body><header><div><a href=/ class=logo><img width=160px src=/img/esther.png></a></div><div><nav id=nav class="nav justify-content-end"><a class=nav-link title=Esther href=/esther/ target=_self><i data-feather=message-circle></i></a><a class=nav-link title=Blog href=/posts/ target=_self><i data-feather=book-open></i></a><a class=nav-link title=Portfolio href=/portfolio/ target=_self><i data-feather=briefcase></i></a><a class=nav-link title=Playground href=/playground/ target=_self><i data-feather=box></i></a><a class=nav-link title=Github href=https://github.com/estherj-hsu target=_blank><i data-feather=github></i></a><a class=nav-link title=LinkedIn href=https://www.linkedin.com/in/estherjhsu/ target=_blank><i data-feather=linkedin></i></a></nav></div></header><main><h1 class=text-center>CSS優化項目之一：多語系選單</h1><div class="text-center mt-4 mb-5"><div class=meta><i width=14px height=14px data-feather=calendar></i><time datetime=2017-09-18>Sep 18, 2017</time>
<span class=mx-3></span><i width=14px height=14px data-feather=tag></i><a class=tag href=/tags/css/sass>CSS/sass</a></div></div><h3 id=esther>esther</h3><p>想記錄一下自己去年優化的幾個部分，不堪回想的血淚&mldr; T^T<br>剛接觸 sass 時，會被他很厲害的功能迷惑，<br>曾經我也不自覺地濫用了很多的 <code>@extend</code>，<br>但是如果弄清楚需求與效能後，<br>會知道很多東西其實維持舊寫法才是比較適當的選擇。<br>就讓我們繼續看下去吧&mldr;</p><hr><h2 id=needs>Needs?</h2><p>選單的需求很單純：
1. 多階層選單
2. 大項目分類與旗下所有子項目清單
3. 不同語系會有不同寬度與欄數
4. 每一列下方會有分隔線</p><p>原本（不是我的）做法是各別將語系的寬度與欄數做了兩個 map 以及一個 map-get 的 function，<br>先以語系的寬度 map 跑 <code>@each</code> 後，再針對語系去 get 該語系欄數的 map，<br>最後還針對分隔線多了無謂的計算。</p><p>寫到這裡應該大概能理解為什麼要優化這塊的CSS了？</p><hr><h3 id=after-optimization>After optimization?</h3><div class=highlight><pre class=chroma><code class=language-sass data-lang=sass><span class=o>/</span><span class=o>/</span> <span class=nt>懶人用專用</span> <span class=nt>font</span> <span class=k>&amp;</span> <span class=nt>position</span> <span class=k>&amp;</span> <span class=nt>size</span> <span class=nt>mixin</span>
<span class=nf>=fs</span><span class=p>(</span><span class=nv>$fz</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$c</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$lh</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$fw</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$fm</span><span class=o>:</span> <span class=n>null</span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>font-size</span><span class=o>:</span> <span class=nv>$fz</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>color</span><span class=o>:</span> <span class=nv>$c</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>line-height</span><span class=o>:</span> <span class=nv>$lh</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>font-weight</span><span class=o>:</span> <span class=nv>$fw</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>font-family</span><span class=o>:</span> <span class=nv>$fm</span>
<span class=nf>=pos</span><span class=p>(</span><span class=nv>$p</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$t</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$r</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$b</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$l</span><span class=o>:</span> <span class=n>null</span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>position</span><span class=o>:</span> <span class=nv>$p</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>top</span><span class=o>:</span> <span class=nv>$t</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>right</span><span class=o>:</span> <span class=nv>$r</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>bottom</span><span class=o>:</span> <span class=nv>$b</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>left</span><span class=o>:</span> <span class=nv>$l</span>
<span class=nf>=size</span><span class=p>(</span><span class=nv>$w</span><span class=o>:</span> <span class=n>null</span><span class=o>,</span> <span class=nv>$h</span><span class=o>:</span> <span class=n>null</span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>width</span><span class=o>:</span> <span class=nv>$w</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>height</span><span class=o>:</span> <span class=nv>$h</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>需要的</span> <span class=nt>map</span> <span class=nt>與</span> <span class=nt>變數</span>
<span class=o>/</span><span class=o>/</span> <span class=nt>不同語系時清單的寬度與每列欄數</span>
<span class=nv>$menuListCol</span><span class=o>:</span> <span class=p>(</span><span class=n>en-us</span><span class=o>:</span> <span class=p>(</span><span class=mi>164</span><span class=kt>px</span><span class=o>,</span> <span class=mi>4</span><span class=kt></span><span class=p>)</span><span class=o>,</span> <span class=n>zh-tw</span><span class=o>:</span> <span class=p>(</span><span class=mi>110</span><span class=kt>px</span><span class=o>,</span> <span class=mi>6</span><span class=kt></span><span class=p>)</span><span class=o>,</span> <span class=n>ko-kr</span><span class=o>:</span> <span class=p>(</span><span class=mi>142</span><span class=kt>px</span><span class=o>,</span> <span class=mi>5</span><span class=kt></span><span class=p>))</span>
<span class=o>/</span><span class=o>/</span> <span class=nt>gutter</span> <span class=nt>or</span> <span class=nt>gap</span> <span class=nt>看你喜歡怎樣叫</span>
<span class=nv>$menuListGap</span><span class=o>:</span> <span class=mi>30</span><span class=kt>px</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>清單用</span> <span class=nt>flex</span> <span class=nt>唷</span>
<span class=nc>.</span><span class=nc>menuList</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>align-content</span><span class=o>:</span> <span class=n>stretch</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>box-sizing</span><span class=o>:</span> <span class=no>content</span><span class=o>-</span><span class=n>box</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>display</span><span class=o>:</span> <span class=no>flex</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>flex-flow</span><span class=o>:</span> <span class=n>row</span> <span class=n>wrap</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>justify-content</span><span class=o>:</span> <span class=no>flex</span><span class=o>-</span><span class=n>start</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>padding</span><span class=o>:</span> <span class=mi>0</span><span class=kt></span> <span class=mi>25</span><span class=kt>px</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>分類標題</span>
<span class=nc>.</span><span class=nc>menuList-title</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>+fs($fz</span><span class=o>:</span> <span class=mi>18</span><span class=kt>px</span><span class=o>,</span> <span class=nv>$c</span><span class=o>:</span> <span class=mh>#455A64</span><span class=o>,</span> <span class=nv>$fw</span><span class=o>:</span> <span class=no>normal</span><span class=o>,</span> <span class=nv>$lh</span><span class=o>:</span> <span class=mi>18</span><span class=kt>px</span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>padding-bottom</span><span class=o>:</span> <span class=mi>10</span><span class=kt>px</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>分類群組</span>
<span class=nc>.</span><span class=nc>menuList-group</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>align-items</span><span class=o>:</span> <span class=n>stretch</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>margin-right</span><span class=o>:</span> <span class=nv>$menuListGap</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>padding</span><span class=o>:</span> <span class=mi>38</span><span class=kt>px</span> <span class=mi>0</span><span class=kt></span> <span class=mi>30</span><span class=kt>px</span> <span class=mi>0</span><span class=kt></span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>position</span><span class=o>:</span> <span class=no>relative</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>分類子項</span>
<span class=nc>.</span><span class=nc>menuList-item</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>+fs($fz</span><span class=o>:</span> <span class=mi>14</span><span class=kt>px</span><span class=o>,</span> <span class=nv>$c</span><span class=o>:</span> <span class=mh>#999</span><span class=o>,</span> <span class=nv>$lh</span><span class=o>:</span> <span class=mi>1</span><span class=kt></span><span class=mf>.4</span><span class=kt></span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>margin</span><span class=o>:</span> <span class=mi>10</span><span class=kt>px</span> <span class=mi>0</span><span class=kt></span> <span class=mi>0</span><span class=kt></span> <span class=mi>0</span><span class=kt></span>
  <span class=k>&amp;</span><span class=nd>:</span><span class=nd>first-of-type</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>margin-top</span><span class=o>:</span> <span class=mi>0</span><span class=kt></span>
  <span class=k>&amp;</span><span class=nd>:</span><span class=nd>hover</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>color</span><span class=o>:</span> <span class=mh>#455A64</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>重點在這裡</span><span class=err>，</span><span class=nt>套入</span> <span class=nt>map</span> <span class=nt>內的資料與</span> <span class=nt>gap</span><span class=err>，</span><span class=nt>針對不同語系時給予不同的寬度</span>
<span class=k>@each</span> <span class=err>$</span><span class=nt>lang</span><span class=o>,</span> <span class=err>$</span><span class=nt>cols</span> <span class=nt>in</span> <span class=err>$</span><span class=nt>menuListCol</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>$colW</span><span class=o>:</span> <span class=nf>nth</span><span class=p>(</span><span class=nv>$cols</span><span class=o>,</span> <span class=mi>1</span><span class=kt></span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>$colN</span><span class=o>:</span> <span class=nf>nth</span><span class=p>(</span><span class=nv>$cols</span><span class=o>,</span> <span class=mi>2</span><span class=kt></span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>$allW</span><span class=o>:</span> <span class=nv>$colW</span> <span class=o>*</span> <span class=nv>$colN</span> <span class=o>+</span> <span class=nv>$menuListGap</span> <span class=o>*</span> <span class=p>(</span><span class=nv>$colN</span> <span class=o>-</span> <span class=mi>1</span><span class=kt></span><span class=p>)</span>
  <span class=nt>html</span><span class=nd>:</span><span class=nd>lang</span><span class=o>(</span><span class=nn>#</span><span class=err>{</span><span class=err>$</span><span class=nt>lang</span><span class=err>}</span><span class=o>)</span>
    <span class=nc>.</span><span class=nc>menuList</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>width</span><span class=o>:</span> <span class=nv>$allW</span>
    <span class=nc>.</span><span class=nc>menuList-group</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>width</span><span class=o>:</span> <span class=nv>$colW</span>
      <span class=k>&amp;</span><span class=nd>:</span><span class=nd>nth-of-type</span><span class=o>(</span><span class=nn>#</span><span class=err>{</span><span class=err>$</span><span class=nt>colN</span><span class=err>}</span><span class=nt>n</span><span class=o>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>margin-right</span><span class=o>:</span> <span class=mi>0</span><span class=kt></span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>&amp;</span><span class=o>:</span><span class=nf>nth-of-type</span><span class=p>(</span><span class=si>#{</span><span class=nv>$colN</span><span class=si>}</span><span class=n>n-0</span><span class=p>)</span><span class=o>::</span><span class=n>after</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>+pos($p</span><span class=o>:</span> <span class=no>absolute</span><span class=o>,</span> <span class=nv>$r</span><span class=o>:</span> <span class=mi>0</span><span class=kt></span><span class=o>,</span> <span class=nv>$b</span><span class=o>:</span> <span class=mi>0</span><span class=kt></span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>+size($w</span><span class=o>:</span> <span class=nv>$allW</span><span class=o>,</span> <span class=nv>$h</span><span class=o>:</span> <span class=mi>1</span><span class=kt>px</span><span class=p>)</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>background-color</span><span class=o>:</span> <span class=mh>#e5e5e5</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>content</span><span class=o>:</span> <span class=s1>&#39;</span><span class=s1>&#39;</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>display</span><span class=o>:</span> <span class=no>inline</span><span class=o>-</span><span class=no>block</span></code></pre></div><blockquote><p>懶人專用那部分其實就是活用 sass 的 mixin 節省寫 code 時間的好例子，
比起 editor 本身的 autocomplete 或是 emmet 的 abbreviations，
我反而比較習慣這種用法？（單純討厭背東西）</p></blockquote><h3 id=result>Result</h3><p><p data-height=400 data-theme-id=dark data-slug-hash=wrKOKa data-default-tab=result data-user=estherj-hsu data-embed-version=2 data-pen-title=wrKOKa class=codepen>See the Pen <a href=https://codepen.io/estherj-hsu/pen/wrKOKa/>wrKOKa</a> by Esther (<a href=https://codepen.io/estherj-hsu>@estherj-hsu</a>) on <a href=https://codepen.io>CodePen</a>.</p><script async src=https://production-assets.codepen.io/assets/embed/ei.js></script></p></main><footer class="footer text-center"><p class=text-muted><small>Designed by EstherJ <span class=mx-2>|</span> Copyright © 2023</small></p></footer><script src=/js/feather.min.js></script><script>feather.replace()</script><script src=/js/jquery-3.5.1.min.js></script><script src=/js/jquery.fancybox.min.js></script></body></html>