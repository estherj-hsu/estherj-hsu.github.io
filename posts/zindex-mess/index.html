<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&family=Rubik:ital,wght@0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css integrity=sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l crossorigin=anonymous><link rel=stylesheet type=text/css href=/css/style.css><title>z-index 之亂 ｜ Esther's Life</title><meta name=description content="esther 再次強調：*所有強人分享的方法都有優缺點，也都有適用性的問題*。
找到好方法，要先能完整理解概念後，再來思考如何針對自己需求做調整，不要只知道照抄，若不了解其中原理，用到最後也會失去方向。
另外，對頁面圖層概念若不清楚，有再好的工具/方法都無法做到正確管理 z-index！
盡量藉由切版來避免元件中子元件的層次問題，而非一昧的堆疊元件後再利用工具/方法去做 z-index 管理，這種方式只會本末倒置！"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-ZS1GBZ1JP6','auto');ga('send','pageview');}</script><link rel="shortcut icon" href=/images/favicon.ico></head><body><header><div><a href=/ class=logo><img width=160px src=/img/esther.png></a></div><div><nav id=nav class="nav justify-content-end"><a class=nav-link title=Esther href=/esther/ target=_self><i data-feather=message-circle></i></a><a class=nav-link title=Blog href=/posts/ target=_self><i data-feather=book-open></i></a><a class=nav-link title=Portfolio href=/portfolio/ target=_self><i data-feather=briefcase></i></a><a class=nav-link title=Playground href=/playground/ target=_self><i data-feather=box></i></a><a class=nav-link title=Github href=https://github.com/estherj-hsu target=_blank><i data-feather=github></i></a><a class=nav-link title=LinkedIn href=https://www.linkedin.com/in/estherjhsu/ target=_blank><i data-feather=linkedin></i></a></nav></div></header><main><h1 class=text-center>z-index 之亂</h1><div class="text-center mt-4 mb-5"><div class=meta><i width=14px height=14px data-feather=calendar></i><time datetime=2016-12-09>Dec 9, 2016</time>
<span class=mx-3></span><i width=14px height=14px data-feather=tag></i><a class=tag href=/tags/css/sass>CSS/sass</a></div></div><h3 id=esther>esther</h3><p>再次強調：*所有強人分享的方法都有優缺點，也都有適用性的問題*。<br>找到好方法，要先能完整理解概念後，再來思考如何針對自己需求做調整，不要只知道照抄，若不了解其中原理，用到最後也會失去方向。<br>另外，對頁面圖層概念若不清楚，有再好的工具/方法都無法做到正確管理 <code>z-index</code>！<br>盡量藉由切版來避免元件中子元件的層次問題，而非一昧的堆疊元件後再利用工具/方法去做 <code>z-index</code> 管理，這種方式只會本末倒置！</p><hr><h3 id=前言>前言</h3><p>在前陣子的地獄 CSS 重構期間，一直很困惑明明使用了 z-index map 做管理（源自 Hugo Giraudel），卻還是遇到其他開法者無法有效率且正確使用 <code>z-index</code> 問題。</p><p>搜尋 <code>z-index</code> 管理相關文章時，剛好看到 <a href=http://muki.tw/tech/sass-z-index-management/ target=_blank>MUKI</a> 針對 sass 控管 <code>z-index</code> 圖層的文章，才發現原來 <a href=http://www.sassmeister.com/gist/11172138 target=_blank>Hugo Giraudel</a> 的概念是來自於 Jackie Balzer 的 <a href=https://www.smashingmagazine.com/2014/06/sassy-z-index-management-for-complex-layouts/ target=_blank>Sassy Z-Index Management For Complex Layouts</a>。</p><p>花了點時間研究了這篇文章的概念，基本上比較符合目前公司超大型專案的架構，索性整理了一下兩者的差異和優缺點：
- Balzer 的解法是針對（超）大型專案下，大架構本身需要圖層管理，內部小專案的元件也需要圖層管理的情境，可以有類似樹狀圖概念的管理方式。
- Giraudel 的解法則是單純針對一般專案下的單一層次管理，適用架構本身不複雜的專案。</p><h3 id=why-z-index>Why z-index?</h3><p>Jackie Balzer 的文章中有提到三點使用 <code>z-index</code> 時須釐清的問題：</p><ol><li>為何此元件需要使用 <code>z-index</code>？這個元件代表的意義是？</li><li>適合此元件的位置次序是什麼？若增加是否會影響其他元件？</li><li>若增加此元件的 <code>z-index</code>，哪些其他的元件次序同時也會被增加？</li></ol><p>以我遇到的情況而言，其他開發者針對單一專案就增加了6層的圖層，但實際上都是小元件（如按鈕），這樣的狀況除了切版本身（不當堆疊）的問題外，我也發現若對圖層概念不清楚，即便有再好的管理工具，問題也會持續存在（然後隨著專案越大，就越亂惹 😱）。</p><p>因此，若能在使用 <code>z-index</code> 之前釐清這三點，勢必會對 <code>z-index</code> 的使用有更完整的概念，也能更好管理。</p><h3 id=jackie-balzer-的-z-index-管理方式>Jackie Balzer 的 z-index 管理方式</h3><p>elements 為外層架構元件，modal-elements 為外層架構中 modals 的子元件，每增加一個元件就會自動排序，這種做法可以避免不同大型元件中的 <code>z-index</code> 交互影響，也可以避免元件內的子元件層次過多時排序混亂的問題。</p><div class=highlight><pre class=chroma><code class=language-sass data-lang=sass><span class=o>/</span><span class=o>/</span> <span class=nt>變數清單</span>
<span class=nv>$elements</span><span class=o>:</span> <span class=n>project-covers</span><span class=o>,</span> <span class=n>user-tooltip</span><span class=o>,</span> <span class=n>sorting-bar</span><span class=o>,</span> <span class=n>modals</span>
<span class=o>/</span><span class=o>/</span> <span class=nt>變數清單</span><span class=err>：</span><span class=nt>modals</span> <span class=nt>子元件</span>
<span class=na></span><span class=na>$modal-elements</span><span class=o>:</span> <span class=n>fields</span><span class=o>,</span> <span class=n>form-controls</span><span class=o>,</span> <span class=n>errors</span><span class=o>,</span> <span class=n>autocomplete-dropdown</span>
<span class=o>/</span><span class=o>/</span> <span class=nt>z-index</span> <span class=nt>呼叫</span>
<span class=nc>.</span><span class=nc>project-covers</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$elements</span><span class=o>,</span> <span class=n>project-covers</span><span class=p>)</span>                   <span class=c1>// z-index: 1</span>
<span class=nc>.</span><span class=nc>user-tooltip</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$elements</span><span class=o>,</span> <span class=n>user-tooltip</span><span class=p>)</span>                     <span class=c1>// z-index: 2</span>
<span class=nc>.</span><span class=nc>sorting-bar</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$elements</span><span class=o>,</span> <span class=n>sorting-bar</span><span class=p>)</span>                      <span class=c1>// z-index: 3</span>
<span class=nc>.</span><span class=nc>modal</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$elements</span><span class=o>,</span> <span class=n>modals</span><span class=p>)</span>                          <span class=c1>// z-index: 4</span>
   <span class=nc>.</span><span class=nc>field</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$modal-elements</span><span class=o>,</span> <span class=n>fields</span><span class=p>)</span>                 <span class=c1>// z-index: 1</span>
   <span class=nc>.</span><span class=nc>form-controls</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$modal-elements</span><span class=o>,</span> <span class=n>form-controls</span><span class=p>)</span>          <span class=c1>// z-index: 2</span>
   <span class=nc>.</span><span class=nc>error</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$modal-elements</span><span class=o>,</span> <span class=n>errors</span><span class=p>)</span>                 <span class=c1>// z-index: 3</span>
   <span class=nc>.</span><span class=nc>autocomplete-dropdown</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>index</span><span class=p>(</span><span class=nv>$modal-elements</span><span class=o>,</span> <span class=n>autocomplete-dropdown</span><span class=p>)</span>  <span class=c1>// z-index: 4</span></code></pre></div><h3 id=hugo-giraudel-的-z-index-管理方式>Hugo Giraudel 的 z-index 管理方式</h3><p>這種方式是單純使用 sass 的 maps 做管理，可以針對不同元件手動設定需要的 <code>z-index</code>，缺點是單一 map 管理的情況下，無法解決多框架下的多層次問題，且必須依靠手動調整所有元件的 <code>z-index</code> 值來做設定，若在共同開發的情況下，開發者還是須要了解每個元件的層次結構，才能避免交互影響，另一個需注意的問題是，<code>z-index</code> 為手動輸入，某方面不太符合 <code>z-index</code> 簡要使用方式。</p><div class=highlight><pre class=chroma><code class=language-sass data-lang=sass><span class=o>/</span><span class=o>/</span> <span class=nt>z-index</span> <span class=nt>maps</span>
<span class=na></span><span class=na>$z-layers</span><span class=o>:</span> <span class=p>(</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>&#39;modal&#39;</span><span class=o>:</span>              <span class=mi>5000</span><span class=kt></span><span class=o>,</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>&#39;dropdown&#39;</span><span class=o>:</span>           <span class=mi>4000</span><span class=kt></span><span class=o>,</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>&#39;default&#39;</span><span class=o>:</span>               <span class=mi>1</span><span class=kt></span><span class=o>,</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>&#39;bottomless-pit&#39;</span><span class=o>:</span>   <span class=mi>-10000</span><span class=kt></span>
<span class=o>)</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>function</span> <span class=nt>for</span> <span class=nt>z-index</span> <span class=nt>map-get</span>
<span class=k>@function</span> <span class=nt>z</span><span class=o>(</span><span class=err>$</span><span class=nt>layer</span><span class=o>)</span>
  <span class=o>@</span><span class=nt>if</span> <span class=nt>not</span> <span class=nt>map-has-key</span><span class=o>(</span><span class=err>$</span><span class=nt>z-layers</span><span class=o>,</span> <span class=err>$</span><span class=nt>layer</span><span class=o>)</span>
    <span class=o>@</span><span class=nt>warn</span> <span class=s2>&#34;</span><span class=s2>No z-index found in $z-layers map for `</span><span class=si>#{</span><span class=nv>$layer</span><span class=si>}</span><span class=s2>`. Property omitted.</span><span class=s2>&#34;</span>
  <span class=o>@</span><span class=nt>return</span> <span class=nt>map-get</span><span class=o>(</span><span class=err>$</span><span class=nt>z-layers</span><span class=o>,</span> <span class=err>$</span><span class=nt>layer</span><span class=o>)</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>z-index</span> <span class=nt>calling</span>
<span class=nc>.</span><span class=nc>modal</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>modal</span><span class=s2>&#34;</span><span class=p>)</span>                        <span class=c1>// z-index: 5000</span>
<span class=nc>.</span><span class=nc>modal-backdrop</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>modal</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=kt></span>                    <span class=c1>// z-index: 5001</span>
<span class=nc>.</span><span class=nc>dropdown</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>dropdown</span><span class=s2>&#34;</span><span class=p>)</span>                     <span class=c1>// z-index: 4000</span>
<span class=nc>.</span><span class=nc>element</span><span class=nd>:</span><span class=nd>after</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>default</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>-</span> <span class=mi>2</span><span class=kt></span>                  <span class=c1>// z-index: -1</span>
<span class=nc>.</span><span class=nc>im-falling</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>bottomless-pit</span><span class=s2>&#34;</span><span class=p>)</span>               <span class=c1>// z-index: -10000</span>
<span class=nc>.</span><span class=nc>error</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>unknown-z-index</span><span class=s2>&#34;</span><span class=p>)</span>              <span class=c1>// z-index: ?</span></code></pre></div><hr><p>以下是我針對 Giraudel 的架構做多元件管理提供的簡單範例（省略 function 部分）</p><div class=highlight><pre class=chroma><code class=language-sass data-lang=sass><span class=o>/</span><span class=o>/</span> <span class=nt>z-index</span> <span class=nt>maps</span>
<span class=na></span><span class=na>$z-layers</span><span class=o>:</span> <span class=p>(</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>&#39;header&#39;</span><span class=o>:</span>               <span class=mi>100</span><span class=kt></span><span class=o>,</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>&#39;goTop&#39;</span><span class=o>:</span>                <span class=mi>200</span><span class=kt></span><span class=o>,</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>&#39;popupBox&#39;</span><span class=o>:</span>             <span class=mi>300</span><span class=kt></span>
<span class=o>)</span>

<span class=o>/</span><span class=o>/</span> <span class=nt>z-index</span> <span class=nt>calling</span>
<span class=nc>.</span><span class=nc>header</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>header</span><span class=s2>&#34;</span><span class=p>)</span>                        <span class=c1>// z-index: 100</span>
  <span class=nc>.</span><span class=nc>header-logo</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>header</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=kt></span>                  <span class=c1>// z-index: 101</span>
<span class=nc>.</span><span class=nc>goTop</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>goTop</span><span class=s2>&#34;</span><span class=p>)</span>                         <span class=c1>// z-index: 200</span>
<span class=nc>.</span><span class=nc>popupBox</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>popupBox</span><span class=s2>&#34;</span><span class=p>)</span>                      <span class=c1>// z-index: 300</span>
  <span class=nc>.</span><span class=nc>popupBox-mask</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>popupBox</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=kt></span>                <span class=c1>// z-index: 299</span>
  <span class=nc>.</span><span class=nc>popupBox-msg</span>
<span class=na></span><span class=err> </span><span class=err> </span><span class=err> </span><span class=err> </span><span class=na>z-index</span><span class=o>:</span> <span class=nf>z</span><span class=p>(</span><span class=s2>&#34;</span><span class=s2>popupBox</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=kt></span>                <span class=c1>// z-index: 301</span></code></pre></div></main><footer class="footer text-center"><p class=text-muted><small>Designed by EstherJ <span class=mx-2>|</span> Copyright © 2022</small></p></footer><script src=/js/feather.min.js></script><script>feather.replace()</script><script src=/js/jquery-3.5.1.min.js></script><script src=/js/jquery.fancybox.min.js></script></body></html>